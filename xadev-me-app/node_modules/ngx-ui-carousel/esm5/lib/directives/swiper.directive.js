/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Directive, HostListener, ElementRef, Renderer2, Output, EventEmitter } from '@angular/core';
/** @type {?} */
var ZERO = 0.000000000001;
var SwiperDirective = /** @class */ (function () {
    function SwiperDirective(el, renderer) {
        this.el = el;
        this.renderer = renderer;
        this.isDown = false;
        this.initialPos = ZERO;
        this.lastPos = ZERO;
        this.swipeDistance = ZERO;
        this.firstSwipeDate = Date.now();
        this.onSwipeRight = new EventEmitter();
        this.onSwipeLeft = new EventEmitter();
        this.onSwipeStart = new EventEmitter();
        this.onSwipeEnd = new EventEmitter();
        this.swipeLeft = new EventEmitter();
        this.swipeRight = new EventEmitter();
    }
    // tslint:disable-next-line:use-life-cycle-interface
    // tslint:disable-next-line:use-life-cycle-interface
    /**
     * @return {?}
     */
    SwiperDirective.prototype.ngOnInit = 
    // tslint:disable-next-line:use-life-cycle-interface
    /**
     * @return {?}
     */
    function () {
        this.onSwipeEnd.subscribe((/**
         * @return {?}
         */
        function () {
        }));
        this.swipeLeft.subscribe((/**
         * @return {?}
         */
        function () {
            SwiperDirective.canISwipe = false;
            setTimeout((/**
             * @return {?}
             */
            function () {
                SwiperDirective.canISwipe = true;
            }), 350);
        }));
        this.swipeRight.subscribe((/**
         * @return {?}
         */
        function () {
            SwiperDirective.canISwipe = false;
            setTimeout((/**
             * @return {?}
             */
            function () {
                SwiperDirective.canISwipe = true;
            }), 350);
        }));
    };
    /**
     * @param {?} event
     * @return {?}
     */
    SwiperDirective.prototype.onMouseDown = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (!SwiperDirective.canISwipe) {
            return;
        }
        this.firstSwipeDate = Date.now();
        this.isDown = true;
        this.initialPos = event.clientX;
        this.swipeDistance = 0;
        this.onSwipeStart.emit();
    };
    /**
     * @param {?} event
     * @return {?}
     */
    SwiperDirective.prototype.onMouseUp = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (!this.isDown) {
            return;
        }
        this.initialPos = this.lastPos = ZERO;
        this.isDown = false;
        if (this.swipeDistance > 100) {
            this.swipeLeft.emit();
        }
        else if (this.swipeDistance < -100) {
            this.swipeRight.emit();
        }
        else {
            this.onSwipeEnd.emit();
        }
        this.swipeDistance = ZERO;
    };
    /**
     * @param {?} event
     * @return {?}
     */
    SwiperDirective.prototype.onMouseMove = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (this.isDown) {
            /** @type {?} */
            var swipeFrameDistance = event.clientX - this.initialPos - this.lastPos;
            this.swipeDistance += swipeFrameDistance;
            this.lastPos = event.clientX - this.initialPos;
            if (swipeFrameDistance > 0) {
                this.onSwipeLeft.emit(swipeFrameDistance);
            }
            else {
                this.onSwipeRight.emit(swipeFrameDistance);
            }
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    SwiperDirective.prototype.onTouchMove = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (!SwiperDirective.canISwipe) {
            return;
        }
        /** @type {?} */
        var touch = event.touches[0] || event.changedTouches[0];
        /** @type {?} */
        var swipeFrameDistance = touch.clientX - this.initialPos - this.lastPos;
        swipeFrameDistance = swipeFrameDistance < 30 ? swipeFrameDistance : 30;
        this.swipeDistance += swipeFrameDistance;
        this.lastPos = touch.clientX - this.initialPos;
        if (swipeFrameDistance > 0) {
            this.onSwipeLeft.emit(swipeFrameDistance);
        }
        else {
            this.onSwipeRight.emit(swipeFrameDistance);
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    SwiperDirective.prototype.onTouchStart = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (!SwiperDirective.canISwipe) {
            return;
        }
        /** @type {?} */
        var touch = event.touches[0] || event.changedTouches[0];
        this.firstSwipeDate = Date.now();
        this.initialPos = touch.clientX;
        this.swipeDistance = ZERO;
        this.onSwipeStart.emit();
    };
    /**
     * @param {?} event
     * @return {?}
     */
    SwiperDirective.prototype.onTouchEnd = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.initialPos = this.lastPos = ZERO;
        if (this.swipeDistance > 100) {
            this.swipeLeft.emit();
        }
        else if (this.swipeDistance < -100) {
            this.swipeRight.emit();
        }
        else {
            this.onSwipeEnd.emit();
        }
        this.swipeDistance = ZERO;
    };
    SwiperDirective.canISwipe = true;
    SwiperDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[libSwiper]',
                    exportAs: 'swiper'
                },] }
    ];
    /** @nocollapse */
    SwiperDirective.ctorParameters = function () { return [
        { type: ElementRef },
        { type: Renderer2 }
    ]; };
    SwiperDirective.propDecorators = {
        onSwipeRight: [{ type: Output }],
        onSwipeLeft: [{ type: Output }],
        onSwipeStart: [{ type: Output }],
        onSwipeEnd: [{ type: Output }],
        swipeLeft: [{ type: Output }],
        swipeRight: [{ type: Output }],
        onMouseDown: [{ type: HostListener, args: ['mousedown', ['$event'],] }],
        onMouseUp: [{ type: HostListener, args: ['document:mouseup', ['$event'],] }],
        onMouseMove: [{ type: HostListener, args: ['mousemove', ['$event'],] }],
        onTouchMove: [{ type: HostListener, args: ['touchmove', ['$event'],] }],
        onTouchStart: [{ type: HostListener, args: ['touchstart', ['$event'],] }],
        onTouchEnd: [{ type: HostListener, args: ['touchend', ['$event'],] }]
    };
    return SwiperDirective;
}());
export { SwiperDirective };
if (false) {
    /** @type {?} */
    SwiperDirective.canISwipe;
    /** @type {?} */
    SwiperDirective.prototype.isDown;
    /** @type {?} */
    SwiperDirective.prototype.initialPos;
    /** @type {?} */
    SwiperDirective.prototype.lastPos;
    /** @type {?} */
    SwiperDirective.prototype.swipeDistance;
    /** @type {?} */
    SwiperDirective.prototype.firstSwipeDate;
    /** @type {?} */
    SwiperDirective.prototype.onSwipeRight;
    /** @type {?} */
    SwiperDirective.prototype.onSwipeLeft;
    /** @type {?} */
    SwiperDirective.prototype.onSwipeStart;
    /** @type {?} */
    SwiperDirective.prototype.onSwipeEnd;
    /** @type {?} */
    SwiperDirective.prototype.swipeLeft;
    /** @type {?} */
    SwiperDirective.prototype.swipeRight;
    /**
     * @type {?}
     * @private
     */
    SwiperDirective.prototype.el;
    /**
     * @type {?}
     * @private
     */
    SwiperDirective.prototype.renderer;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3dpcGVyLmRpcmVjdGl2ZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC11aS1jYXJvdXNlbC8iLCJzb3VyY2VzIjpbImxpYi9kaXJlY3RpdmVzL3N3aXBlci5kaXJlY3RpdmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLFVBQVUsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxNQUFNLGVBQWUsQ0FBQzs7SUFFL0YsSUFBSSxHQUFHLGNBQWM7QUFFM0I7SUFtQkUseUJBQW9CLEVBQWMsRUFBVSxRQUFtQjtRQUEzQyxPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQVUsYUFBUSxHQUFSLFFBQVEsQ0FBVztRQWJ4RCxXQUFNLEdBQUcsS0FBSyxDQUFDO1FBQ2YsZUFBVSxHQUFXLElBQUksQ0FBQztRQUMxQixZQUFPLEdBQVcsSUFBSSxDQUFDO1FBQ3ZCLGtCQUFhLEdBQVcsSUFBSSxDQUFDO1FBQzdCLG1CQUFjLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBRWxCLGlCQUFZLEdBQXNCLElBQUksWUFBWSxFQUFPLENBQUM7UUFDMUQsZ0JBQVcsR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUN6RCxpQkFBWSxHQUFzQixJQUFJLFlBQVksRUFBTyxDQUFDO1FBQzFELGVBQVUsR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUN4RCxjQUFTLEdBQXNCLElBQUksWUFBWSxFQUFPLENBQUM7UUFDdkQsZUFBVSxHQUFzQixJQUFJLFlBQVksRUFBTyxDQUFDO0lBRVAsQ0FBQztJQUVuRSxvREFBb0Q7Ozs7O0lBQ3BELGtDQUFROzs7OztJQUFSO1FBQ0UsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTOzs7UUFBQztRQUMxQixDQUFDLEVBQUMsQ0FBQztRQUNILElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUzs7O1FBQUM7WUFDdkIsZUFBZSxDQUFDLFNBQVMsR0FBRyxLQUFLLENB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VUFBVSxDQUFDLElBQUksRUFBRSxDQUFDO1NBQ3hCO1FBQ0QsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUM7SUFDNUIsQ0FBQztJQXhITSx5QkFBUyxHQUFHLElBQUksQ0FBQzs7Z0JBTHpCLFNBQVMsU0FBQztvQkFDVCxRQUFRLEVBQUUsYUFBYTtvQkFDdkIsUUFBUSxFQUFFLFFBQVE7aUJBQ25COzs7O2dCQVBpQyxVQUFVO2dCQUFFLFNBQVM7OzsrQkFnQnBELE1BQU07OEJBQ04sTUFBTTsrQkFDTixNQUFNOzZCQUNOLE1BQU07NEJBQ04sTUFBTTs2QkFDTixNQUFNOzhCQXNCTixZQUFZLFNBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxDQUFDOzRCQVlwQyxZQUFZLFNBQUMsa0JBQWtCLEVBQUUsQ0FBQyxRQUFRLENBQUM7OEJBa0IzQyxZQUFZLFNBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxDQUFDOzhCQWVwQyxZQUFZLFNBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxDQUFDOytCQWtCcEMsWUFBWSxTQUFDLFlBQVksRUFBRSxDQUFDLFFBQVEsQ0FBQzs2QkFZckMsWUFBWSxTQUFDLFVBQVUsRUFBRSxDQUFDLFFBQVEsQ0FBQzs7SUFZdEMsc0JBQUM7Q0FBQSxBQTlIRCxJQThIQztTQTFIWSxlQUFlOzs7SUFDMUIsMEJBQXdCOztJQUN4QixpQ0FBc0I7O0lBQ3RCLHFDQUFpQzs7SUFDakMsa0NBQThCOztJQUM5Qix3Q0FBb0M7O0lBQ3BDLHlDQUFtQzs7SUFFbkMsdUNBQTJFOztJQUMzRSxzQ0FBMEU7O0lBQzFFLHVDQUEyRTs7SUFDM0UscUNBQXlFOztJQUN6RSxvQ0FBd0U7O0lBQ3hFLHFDQUF5RTs7Ozs7SUFFN0QsNkJBQXNCOzs7OztJQUFFLG1DQUEyQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERpcmVjdGl2ZSwgSG9zdExpc3RlbmVyLCBFbGVtZW50UmVmLCBSZW5kZXJlcjIsIE91dHB1dCwgRXZlbnRFbWl0dGVyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcblxyXG5jb25zdCBaRVJPID0gMC4wMDAwMDAwMDAwMDE7XHJcblxyXG5ARGlyZWN0aXZlKHtcclxuICBzZWxlY3RvcjogJ1tsaWJTd2lwZXJdJyxcclxuICBleHBvcnRBczogJ3N3aXBlcidcclxufSlcclxuZXhwb3J0IGNsYXNzIFN3aXBlckRpcmVjdGl2ZSB7XHJcbiAgc3RhdGljIGNhbklTd2lwZSA9IHRydWU7XHJcbiAgcHVibGljIGlzRG93biA9IGZhbHNlO1xyXG4gIHB1YmxpYyBpbml0aWFsUG9zOiBudW1iZXIgPSBaRVJPO1xyXG4gIHB1YmxpYyBsYXN0UG9zOiBudW1iZXIgPSBaRVJPO1xyXG4gIHB1YmxpYyBzd2lwZURpc3RhbmNlOiBudW1iZXIgPSBaRVJPO1xyXG4gIHB1YmxpYyBmaXJzdFN3aXBlRGF0ZSA9IERhdGUubm93KCk7XHJcblxyXG4gIEBPdXRwdXQoKSBwdWJsaWMgb25Td2lwZVJpZ2h0OiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIEBPdXRwdXQoKSBwdWJsaWMgb25Td2lwZUxlZnQ6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpIHB1YmxpYyBvblN3aXBlU3RhcnQ6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpIHB1YmxpYyBvblN3aXBlRW5kOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIEBPdXRwdXQoKSBwdWJsaWMgc3dpcGVMZWZ0OiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIEBPdXRwdXQoKSBwdWJsaWMgc3dpcGVSaWdodDogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBlbDogRWxlbWVudFJlZiwgcHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXIyKSB7fVxyXG5cclxuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6dXNlLWxpZmUtY3ljbGUtaW50ZXJmYWNlXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgICB0aGlzLm9uU3dpcGVFbmQuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5zd2lwZUxlZnQuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgU3dpcGVyRGlyZWN0aXZlLmNhbklTd2lwZSA9IGZhbHNlO1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBTd2lwZXJEaXJlY3RpdmUuY2FuSVN3aXBlID0gdHJ1ZTtcclxuICAgICAgfSwgMzUwKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5zd2lwZVJpZ2h0LnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgIFN3aXBlckRpcmVjdGl2ZS5jYW5JU3dpcGUgPSBmYWxzZTtcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgU3dpcGVyRGlyZWN0aXZlLmNhbklTd2lwZSA9IHRydWU7XHJcbiAgICAgIH0sIDM1MCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIEBIb3N0TGlzdGVuZXIoJ21vdXNlZG93bicsIFsnJGV2ZW50J10pXHJcbiAgb25Nb3VzZURvd24oZXZlbnQ6IGFueSkge1xyXG4gICAgaWYgKCFTd2lwZXJEaXJlY3RpdmUuY2FuSVN3aXBlKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuZmlyc3RTd2lwZURhdGUgPSBEYXRlLm5vdygpO1xyXG4gICAgdGhpcy5pc0Rvd24gPSB0cnVlO1xyXG4gICAgdGhpcy5pbml0aWFsUG9zID0gZXZlbnQuY2xpZW50WDtcclxuICAgIHRoaXMuc3dpcGVEaXN0YW5jZSA9IDA7XHJcbiAgICB0aGlzLm9uU3dpcGVTdGFydC5lbWl0KCk7XHJcbiAgfVxyXG5cclxuICBASG9zdExpc3RlbmVyKCdkb2N1bWVudDptb3VzZXVwJywgWyckZXZlbnQnXSlcclxuICBvbk1vdXNlVXAoZXZlbnQ6IGFueSkge1xyXG4gICAgaWYgKCF0aGlzLmlzRG93bikge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLmluaXRpYWxQb3MgPSB0aGlzLmxhc3RQb3MgPSBaRVJPO1xyXG4gICAgdGhpcy5pc0Rvd24gPSBmYWxzZTtcclxuXHJcbiAgICBpZiAodGhpcy5zd2lwZURpc3RhbmNlID4gMTAwKSB7XHJcbiAgICAgIHRoaXMuc3dpcGVMZWZ0LmVtaXQoKTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5zd2lwZURpc3RhbmNlIDwgLTEwMCkge1xyXG4gICAgICB0aGlzLnN3aXBlUmlnaHQuZW1pdCgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5vblN3aXBlRW5kLmVtaXQoKTtcclxuICAgIH1cclxuICAgIHRoaXMuc3dpcGVEaXN0YW5jZSA9IFpFUk87XHJcbiAgfVxyXG5cclxuICBASG9zdExpc3RlbmVyKCdtb3VzZW1vdmUnLCBbJyRldmVudCddKVxyXG4gIG9uTW91c2VNb3ZlKGV2ZW50OiBhbnkpIHtcclxuICAgIGlmICh0aGlzLmlzRG93bikge1xyXG4gICAgICBjb25zdCBzd2lwZUZyYW1lRGlzdGFuY2UgPSBldmVudC5jbGllbnRYIC0gdGhpcy5pbml0aWFsUG9zIC0gdGhpcy5sYXN0UG9zO1xyXG4gICAgICB0aGlzLnN3aXBlRGlzdGFuY2UgKz0gc3dpcGVGcmFtZURpc3RhbmNlO1xyXG4gICAgICB0aGlzLmxhc3RQb3MgPSBldmVudC5jbGllbnRYIC0gdGhpcy5pbml0aWFsUG9zO1xyXG5cclxuICAgICAgaWYgKHN3aXBlRnJhbWVEaXN0YW5jZSA+IDApIHtcclxuICAgICAgICB0aGlzLm9uU3dpcGVMZWZ0LmVtaXQoc3dpcGVGcmFtZURpc3RhbmNlKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLm9uU3dpcGVSaWdodC5lbWl0KHN3aXBlRnJhbWVEaXN0YW5jZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIEBIb3N0TGlzdGVuZXIoJ3RvdWNobW92ZScsIFsnJGV2ZW50J10pXHJcbiAgb25Ub3VjaE1vdmUoZXZlbnQ6IGFueSkge1xyXG4gICAgaWYgKCFTd2lwZXJEaXJlY3RpdmUuY2FuSVN3aXBlKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IHRvdWNoID0gZXZlbnQudG91Y2hlc1swXSB8fCBldmVudC5jaGFuZ2VkVG91Y2hlc1swXTtcclxuICAgIGxldCBzd2lwZUZyYW1lRGlzdGFuY2UgPSB0b3VjaC5jbGllbnRYIC0gdGhpcy5pbml0aWFsUG9zIC0gdGhpcy5sYXN0UG9zO1xyXG4gICAgc3dpcGVGcmFtZURpc3RhbmNlID0gc3dpcGVGcmFtZURpc3RhbmNlIDwgMzAgPyBzd2lwZUZyYW1lRGlzdGFuY2UgOiAzMDtcclxuICAgIHRoaXMuc3dpcGVEaXN0YW5jZSArPSBzd2lwZUZyYW1lRGlzdGFuY2U7XHJcbiAgICB0aGlzLmxhc3RQb3MgPSB0b3VjaC5jbGllbnRYIC0gdGhpcy5pbml0aWFsUG9zO1xyXG5cclxuICAgIGlmIChzd2lwZUZyYW1lRGlzdGFuY2UgPiAwKSB7XHJcbiAgICAgIHRoaXMub25Td2lwZUxlZnQuZW1pdChzd2lwZUZyYW1lRGlzdGFuY2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5vblN3aXBlUmlnaHQuZW1pdChzd2lwZUZyYW1lRGlzdGFuY2UpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQEhvc3RMaXN0ZW5lcigndG91Y2hzdGFydCcsIFsnJGV2ZW50J10pXHJcbiAgb25Ub3VjaFN0YXJ0KGV2ZW50OiBhbnkpIHtcclxuICAgIGlmICghU3dpcGVyRGlyZWN0aXZlLmNhbklTd2lwZSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCB0b3VjaCA9IGV2ZW50LnRvdWNoZXNbMF0gfHwgZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF07XHJcbiAgICB0aGlzLmZpcnN0U3dpcGVEYXRlID0gRGF0ZS5ub3coKTtcclxuICAgIHRoaXMuaW5pdGlhbFBvcyA9IHRvdWNoLmNsaWVudFg7XHJcbiAgICB0aGlzLnN3aXBlRGlzdGFuY2UgPSBaRVJPO1xyXG4gICAgdGhpcy5vblN3aXBlU3RhcnQuZW1pdCgpO1xyXG4gIH1cclxuXHJcbiAgQEhvc3RMaXN0ZW5lcigndG91Y2hlbmQnLCBbJyRldmVudCddKVxyXG4gIG9uVG91Y2hFbmQoZXZlbnQ6IGFueSkge1xyXG4gICAgdGhpcy5pbml0aWFsUG9zID0gdGhpcy5sYXN0UG9zID0gWkVSTztcclxuICAgIGlmICh0aGlzLnN3aXBlRGlzdGFuY2UgPiAxMDApIHtcclxuICAgICAgdGhpcy5zd2lwZUxlZnQuZW1pdCgpO1xyXG4gICAgfSBlbHNlIGlmICh0aGlzLnN3aXBlRGlzdGFuY2UgPCAtMTAwKSB7XHJcbiAgICAgIHRoaXMuc3dpcGVSaWdodC5lbWl0KCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLm9uU3dpcGVFbmQuZW1pdCgpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5zd2lwZURpc3RhbmNlID0gWkVSTztcclxuICB9XHJcbn1cclxuIl19